"""Студент: Коробейников Артём Юрьевич на 10 строке
Преподаватель: Кислицин Евгений Вительевич
Дисциплина: Алгоритмы и анализ сложности
Работа: Контрольная или домашняя работа 1
Варианты: 3, 4, 8, 12, 14, 17, 19, 24, 28, 30"""


def task14():
    """Задача 14. Сортировка по многим полям
Ограничение по времени: 2 с. Ограничение по памяти: 64 Mb.
В базе данных хранится N записей, вида (Name, a1, a2, …, ak) – во всех записях
одинаковое число параметров. На вход задачи подается приоритет полей – перестановка на
числах 1, …, k – записи нужно вывести по убыванию в соответствии с этим
приоритетом. В случае, если приоритет полей таков: 3 4 2 1, то это следует воспринимать
так: приоритет значений из 3 колонки самый высокий, приоритет значений из колонки 4
ниже, приоритет значений из колонки 2 еще ниже, а приоритет значений из колонки 1
самый низкий.
Формат входных данных:
N ≤ 1000 количество записей
k: 1 ≤ k ≤ 10 приоритеты полей
p1 p2 … pk – перестановка на k числах, разделитель – пробел
N строк вида
Name a1 a2 … ak
Формат выходных данных:
N строк с именами в порядке, согласно приоритету
Примеры:
Стандартный ввод
3
3
2 1 3
A 1 2 3
B 3 2 1
C 3 1 2
Стандартный вывод
B
A
C
Замечание. Так как колонка под номером 2 самая приоритетная, то переставить
записи можно только двумя способами: (A, B, C) и (B, A, C). Следующий по
приоритетности столбец – первый, и он позволяет выбрать из возможных перестановок
только (B, A, C). Так как осталась ровно одна перестановка, третий приоритет не имеет
значения. """

    n = int(input())

    k = int(input())

    priority = list(map(int, input().split()))

    records = []
    for _ in range(n):
        data = input().split()
        name = data[0]
        values = list(map(int, data[1:]))
        records.append((name, values))

    def compare_records(record1, record2):
        name1, values1 = record1
        name2, values2 = record2

        for field_index in priority:
            idx = field_index - 1
            if values1[idx] > values2[idx]: return -1
            elif values1[idx] < values2[idx]: return 1
        return 0

    for i in range(n):
        for j in range(0, n - i - 1):
            if compare_records(records[j], records[j + 1]) > 0: records[j], records[j + 1] = records[j + 1], records[j]

    for name, priors in records: print(name)


if __name__ == "__main__": task14()